{"version":3,"sources":["../src/command/PermissionCommand.ts"],"names":[],"mappings":"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","file":"PermissionCommand.js","sourcesContent":["import {Command, CommandManager} from \"../manager/CommandManager\";\r\nimport {ApplicationCommandTypes} from \"discord.js/typings/enums\";\r\nimport {ApplicationCommandPermissionData, CommandInteraction} from \"discord.js\";\r\nimport {YoutubeCommand} from \"./YoutubeCommand\";\r\nimport {embed} from \"../utils/embed\";\r\n\r\nexport const PermissionCommand: Command = {\r\n    id: '97792e50-428c-47c5-be48-8407aad98cdb',\r\n    definition: {\r\n        type: ApplicationCommandTypes.CHAT_INPUT,\r\n        name: 'perm',\r\n        description: 'Manage permission for youtube command.',\r\n        defaultPermission: false,\r\n        options: [\r\n            {\r\n                name: 'allow',\r\n                type: \"SUB_COMMAND_GROUP\",\r\n                description: 'Allow a role or user to use youtube command.',\r\n                options: [\r\n                    {\r\n                        name: 'role',\r\n                        type: 'SUB_COMMAND',\r\n                        description: 'Allow a role to use youtube command.',\r\n                        options: [\r\n                            {\r\n                                name: 'role',\r\n                                type: 'ROLE',\r\n                                description: 'Role to allow to use youtube command.',\r\n                                required: true,\r\n                            }\r\n                        ]\r\n                    },\r\n                    {\r\n                        name: 'user',\r\n                        type: 'SUB_COMMAND',\r\n                        description: 'Allow a user to use youtube command.',\r\n                        options: [\r\n                            {\r\n                                name: 'user',\r\n                                type: 'USER',\r\n                                description: 'User to allow to use youtube command.',\r\n                                required: true,\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                name: 'deny',\r\n                type: \"SUB_COMMAND_GROUP\",\r\n                description: 'Allow a role or user to use youtube command.',\r\n                options: [\r\n                    {\r\n                        name: 'role',\r\n                        type: 'SUB_COMMAND',\r\n                        description: 'Deny a role to use youtube command.',\r\n                        options: [\r\n                            {\r\n                                name: 'role',\r\n                                type: 'ROLE',\r\n                                description: 'Role to deny to use youtube command.',\r\n                                required: true,\r\n                            }\r\n                        ]\r\n                    },\r\n                    {\r\n                        name: 'user',\r\n                        type: 'SUB_COMMAND',\r\n                        description: 'Deny a user to use youtube command.',\r\n                        options: [\r\n                            {\r\n                                name: 'user',\r\n                                type: 'USER',\r\n                                description: 'User to deny to use youtube command.',\r\n                                required: true,\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    },\r\n    async handle(interaction: CommandInteraction) {\r\n        let operation = interaction.options.getSubcommandGroup(true);\r\n        let type = interaction.options.getSubcommand(true);\r\n        let target: { id } = type === 'user' ?\r\n            interaction.options.getUser('user') :\r\n            interaction.options.getRole('role');\r\n        let remove = type === 'user' ?\r\n            {\r\n                users: target.id,\r\n            } : {\r\n                roles: target.id,\r\n            }\r\n        let perm: ApplicationCommandPermissionData = {\r\n            id: target.id,\r\n            type: type === 'user' ? 'USER' : 'ROLE',\r\n            permission: operation === 'allow',\r\n        }\r\n        let cmd = await CommandManager.findCommand(interaction.guild, YoutubeCommand.id);\r\n        await cmd.permissions.remove(remove);\r\n        await cmd.permissions.add({\r\n            permissions: [perm]\r\n        });\r\n        await interaction.reply({\r\n            embeds: [embed.info(`Permission ${operation === 'allow' ? 'allowed' : 'denied'} for ${target}`)],\r\n            ephemeral: true,\r\n        });\r\n    }\r\n}\r\n"]}